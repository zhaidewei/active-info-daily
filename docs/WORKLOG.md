# Worklog

## 2026-02-20
- 初始化空仓库并建立 Python 项目结构
- 实现数据抓取：RSS、Twitter RSS（Nitter）、Polymarket
- 实现关键词评分与排序
- 实现分析层：heuristic（默认）+ OpenAI（可选）
- 实现日报生成：Markdown + JSON
- 实现 SQLite 历史存储
- 实现 FastAPI Web 查看页
- 实现 APScheduler 每日定时执行
- 编写架构文档、backlog、README
- 完成本机端到端验证（pytest + run-once）
- 修复 Python 3.9 兼容问题（类型注解与 dataclass）
- 优化性能：仅在 OpenAI 模式抓取 Jina 正文上下文
- 优化可读性：超长 RSS 标题清洗与截断
- Phase 2: 接入 SEC filings 抓取（10-Q/10-K/8-K）
- Phase 2: 增加事件去重模块（URL + 标题近似）
- Phase 2: 增加趋势共振评分模块（主题频次 + 跨源共振）
- 报告增强：新增“数据质量”和“趋势共振”章节
- 报告增强：新增“财报雷达（SEC）”章节
- 增加负面词惩罚，降低坏消息在投资信号中的权重
- 新增测试：去重与趋势模块单测
- 分析层新增 DeepSeek API 兼容支持（provider=deepseek）
- 配置与文档新增 DeepSeek 环境变量说明
- Web 报告页改为 Markdown 渲染（替代原始文本显示）
- 报告新增双语翻译输出（中文/英文，支持 DeepSeek）
- 扩展信息源：新增主流媒体 RSS 与业界博客 RSS
- 优化 RSS 采样：改为轮询聚合，避免前序 feed 占满配额
- 关注行业扩展：加入 Web3（新增媒体/博客源 + 评分关键词 + 趋势主题 + 分析目标）
- 关注行业扩展：加入电力 trading（新增电力市场RSS + 评分关键词 + 趋势主题 + 分析目标）
- 新增电力 trading 评分单测
- 报告新增“电力交易雷达”专栏
- 报告页新增“一键导出长图（PNG）”按钮，便于社媒分享
- 新增财报雷达解释器，结构化输出：事件一句话/方向判断/影响对象/重要性/建议动作
- 财报解释器支持 LLM + 规则回退
- 财报展示改版：合并为单一表格，隐藏中性项，仅展示利好/利空
- 新增 `rerun-analysis` 命令：无需重新抓取，直接重跑分析/翻译/展示
- 报告 JSON 新增 `analysis_input_items` 快照，支持分析阶段重跑
- 新增下载快照阶段：`fetch-only` 写入 `data/snapshots/YYYY-MM-DD.download.json`
- 新增解析阶段命令：`parse-only`（基于快照重跑分析/翻译/渲染）
- 新增 Makefile 常用命令：`make daily/fetch/parse`
- 电力交易雷达升级为“结构化洞察表”，输出核心信号与交易含义（并保留原始链接）
- 修复 DeepSeek 电力解释器 JSON 兼容问题（支持串联 JSON 返回），避免误回退到模板
- 电力解释器提示词升级：强化“短期/中期交易含义”与具体事实输出
- 电力雷达新增信号去重压缩：限制同类信号占比，提高信息密度
- 按使用反馈下线“电力交易雷达”章节（仍保留电力数据源抓取与主分析关注）
- 按使用反馈下线“趋势共振”章节与排序加分（保留基础规则评分）
- 按使用反馈下线“财报雷达”章节与解释器流程（SEC 作为普通输入信号参与主分析）
- 报告结构调整：合并“被忽视的趋势信号 + Watchlist”为“机会跟踪清单”
- 报告展示优化：移除“总览”章节；主标题支持来源统计副标题（小字号）
- 报告可溯源增强：为核心条目追加原始链接编号引用（`[#N](URL)`）
- 机会跟踪清单升级为结构化表格（信号/重要性/跟踪动作/关联链接）
- 新增静态站点导出能力：`active-info export-static`（输出 `site/`，适配 Vercel 托管）
- 新增 Make 目标：`make static` 与 `make vercel`
- 新增 `vercel.json` 路由映射；`.gitignore` 增补 `.vercel/`、`data/snapshots/`、SQLite 临时文件
- `make vercel` 升级为日期感知模式：过去日期优先使用本地快照/历史报告，不触发重新下载
- 新增 SEC Filing 排序上限：单日报告最多保留 5 条，降低对其他信号的挤占
- 趋势保留机制升级：移除关键词硬保底，改为 LLM 创新度优先（强调“现有元素重组”）并将高创新趋势前置
- 分析规则收敛：仅保留“正向/乐观/有增量/有创新”信号（负面与风险主导叙事过滤）
- 报告结构改版为两段：`1) 事实与新闻（正向进展）` + `2) 可能的趋势与机会`
- 下线“股票投资价值积极信号”独立章节；其信息并入趋势机会候选并做去重
- 机会部分改为分层文字（按主题分组 + 机会含义），移除移动端不友好的表格形态与“跟踪动作”字段
- 新增 RSS 导出：`export-static` 自动生成 `site/rss.xml`（日报级订阅）
- 新增 `site_url` 配置入口（CLI/Make），用于 RSS 中绝对链接
- 评分体系升级：从“关键词机械评分”改为“LLM 主评分 + 规则回退”
- 新增 LLM 5维评分规则：正向性/增量性/创新性/可投资传导/可验证性，并支持前置剔除（负面主导、不可验证、领域无关）
- DeepSeek 模型策略调整：默认改为 `deepseek-reasoner`，并新增 `DEEPSEEK_STRICT_MODEL=true`（开启后不回落 `deepseek-chat`）
- 页面品牌升级：标题改为“乐观者的主动信息汇总”，并在页面开头加入主动/被动信息获取的价值观 slogan
- “趋势与机会”展示优化：去除重复“机会含义”标签，改为斜体洞察行，降低视觉冗余
- 报告页中英切换补齐：标题/slogan/来源副标题/返回文案/导出按钮支持中英文联动切换
- 信息源扩展：新增 `Vitalik Buterin (Twitter/Nitter RSS)` 到 `twitter_rss`（分类 `web3`）

## 下一步
- 接入 earnings call transcript
- 增加来源可信度评分
- 设计趋势评分回测指标
